<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.everyfarm.payment.PaymentDAO">
	
	<select id="paylist1"
		resultType="kr.co.everyfarm.payment.PaymentBean">
		      select product.p_Id,product.p_No,product.p_Title,product.p_Img,
		payment.pay_Id,payment.pay_Orderno,payment.pay_Totalprice,payment.pay_Deliverymemo,payment.pay_Date,payment.pay_Address,payment.pay_Name,payment.pay_Tel,payment.pay_Email
		from product, payment where payment.pay_No=product.p_No
  <!--     <if test="searchType == 't'.toString()">
            AND r_mid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'c'.toString()">
            AND r_pid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'w'.toString()">
            AND product.p_name LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'tc'.toString()">
            AND r_state LIKE CONCAT('%', #{keyword},'%')
         </if> -->
      ORDER BY payment.pay_Orderno desc
      limit #{pageStart}, #{perPageNum}
		</select>
	
	   <select id="getPayTotalCount" resultType="int">
      select count(*)
      from member, product, payment where payment.pay_Id=member.m_Id and payment.pay_No=product.p_No
      <!-- <include refid="searchCondition"></include> -->
   </select>
	
<!-- 	   <sql id="searchCondition">
      <if test="searchType != null">
         <if test="searchType == 't'.toString()">
            AND r_mid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'c'.toString()">
            AND r_pid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'w'.toString()">
            AND product.p_name LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'tc'.toString()">
            AND r_state LIKE CONCAT('%', #{keyword},'%')
         </if>
      </if>
   </sql> -->
	
	<select id="farmerpaylist"
		resultType="kr.co.everyfarm.payment.PaymentBean">
		select product.p_No,product.p_Title,payment.pay_seed,payment.pay_land,product.p_Img,payment.pay_Orderno,payment.pay_Totalprice,payment.pay_Deliverymemo,payment.pay_Date,pay_Address
		from product, payment where product.p_Id=#{f_Id} and payment.pay_No=product.p_No
		<!--     <if test="searchType == 't'.toString()">
            AND r_mid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'c'.toString()">
            AND r_pid LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'w'.toString()">
            AND product.p_name LIKE CONCAT('%', #{keyword},'%')
         </if>
         <if test="searchType == 'tc'.toString()">
            AND r_state LIKE CONCAT('%', #{keyword},'%')
         </if> -->
         <!-- ORDER BY payment.pay_Orderno desc
      limit #{pageStart}, #{perPageNum} -->
	</select>


	<select id="getinfo" resultType="int">
		<![CDATA[
		select p_Landavailable from product where p_no=#{p_No} 
		]]>
	</select>


	<insert id="payinsert"
		parameterType="kr.co.everyfarm.payment.PaymentBean">
		<![CDATA[
		insert into payment(pay_no,pay_id,pay_land,pay_seed,pay_totalprice,pay_deliverymemo,pay_address,pay_name,pay_tel,pay_email) 
		values(#{pay_No},#{pay_Id},#{pay_Land},#{pay_Seed},#{pay_Totalprice},#{pay_Deliverymemo},#{pay_Address},#{pay_Name},#{pay_Tel},#{pay_Email})
		]]>
	</insert>

	<select id="sendmessage" resultType="kr.co.everyfarm.payment.PaymentBean">
		select * from payment where
		pay_orderno=#{pay_Orderno}
	</select>

	<delete id="paydelete" parameterType="java.util.List">
		delete from payment 
		where pay_OrderNo IN ( 
		<foreach collection="list" item="deletelist" index="index" separator=",">
            ${deletelist}
        </foreach> 
        )
	</delete>


	<select resultType="kr.co.everyfarm.payment.PaymentBean"
		id="mypaylist">SELECT * FROM payment WHERE pay_Id= #{m_Id} </select>

	<!-- index -->
	<select id="seedList"
		resultType="kr.co.everyfarm.payment.PaymentBean">
		select * from payment order by pay_Seed desc limit 5;
	</select>
	<!-- index -->
	
    		



</mapper>