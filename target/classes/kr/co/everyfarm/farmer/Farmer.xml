<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.everyfarm.farmer.FarmerDAO">

	<select id="flist"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer
	</select>

	<insert id="fjoin"
		parameterType="kr.co.everyfarm.farmer.FarmerBean">
		insert into farmer (f_id,
		f_name, f_pw, f_Addr, f_tel,
		f_birth, f_auth, f_sign)
		Values (#{f_Id}, #{f_Name}, #{f_Pw},
		#{f_Addr},
		#{f_Tel}, #{f_Birth}, #{f_Auth}, #{f_Sign})
	</insert>

	<select id="flogin"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer where f_id =
		#{f_Id} and f_pw = #{f_Pw}
	</select>

	<select id="fInfo"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from member where
		f_id=#{f_Id}
	</select>

	<update id="fUpdate">
		update farmer set
		f_Pw=#{f_Pw},
		f_Name=#{f_Name},
		f_Addr=#{f_Addr},
		f_tel=#{f_Tel},
		f_birth=#{f_Birth},
		f_auth=#{f_Auth},
		where f_id=#{f_Id}
	</update>

	<delete id="fDelete">
		delete from farmer where f_id=#{f_Id}
	</delete>

	<select id="checkId" resultType="int">
		select count(*) from farmer
		where f_Id = #{f_Id}
	</select>

	<update id="upPw">
		update farmer set f_Pw = #{f_Pw} where f_Id = #{f_Id}
	</update>

	<select id="findId"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer where
		f_name=#{f_Name} and
		f_tel=#{f_Tel}
	</select>

	<select id="findPw"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer where
		f_id=#{f_Id} and f_name=#{f_Name}
		and f_tel=#{f_Tel}
	</select>

	<select id="bestFarmer"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		SELECT * FROM farmer order by f_Rate desc limit 3;
	</select>

	<select id="listBefore"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer
		where p_Sign ='N' order by p_Date desc;
	</select>

	<select id="listAfter"
		resultType="kr.co.everyfarm.farmer.FarmerBean">
		select * from farmer
		where p_Sign ='Y' order by p_Date desc;
	</select>

	<insert id="farmerAdd"
		parameterType="kr.co.everyfarm.farmer.FarmerBean">
		insert into farmer (f_id,
		f_name, f_pw, f_Addr, f_tel,
		f_birth, f_auth, f_sign)
		Values (#{f_Id}, #{f_Name}, #{f_Pw},
		'TEST',
		'TEST', 'TEST', 'TEST', 'Y')
	</insert>

	<select id="myCustomer"
		resultType="kr.co.everyfarm.payment.PaymentBean">
		SELECT * FROM payment WHERE pay_No in (select p_no from
		product where p_id =#{f_Id}) ORDER BY pay_orderno
	</select>
	
	<update id="myRate" parameterType="Map">
	UPDATE farmer SET f_Rate =f_Rate + #{rev_Rate} 
	WHERE f_Id = (SELECT p_Id FROM product WHERE p_No=#{pay_No}) 
	</update>
	
</mapper>